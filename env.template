# ========================================
# AUTH SERVICE - ENVIRONMENT TEMPLATE
# ========================================
# Copy this file to .env and update values as needed

# ========================================
# CORE CONFIGURATION
# ========================================
NODE_ENV=development
PORT=3001
HOST=localhost
APP_VERSION=1.0.0

# ========================================
# CORS CONFIGURATION
# ========================================
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:3002

# ========================================
# DATABASE CONFIGURATION (MySQL)
# ========================================
DB_HOST=localhost
DB_PORT=3306
DB_NAME=auth_service_dev
DB_USER=root
DB_PASSWORD=Develop@NN!2345
DB_DIALECT=mysql

# Database Connection Pool
DB_POOL_MAX=5
DB_POOL_MIN=0
DB_POOL_ACQUIRE=30000
DB_POOL_IDLE=10000

# ========================================
# DATABASE CONFIGURATION (MongoDB)
# ========================================
MONGODB_URI=mongodb://localhost:27017/auth_service_dev

# ========================================
# REDIS CONFIGURATION
# ========================================
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=authService:
REDIS_RETRY_DELAY=100
REDIS_MAX_RETRIES=3

# ========================================
# RATE LIMITING REDIS CONFIGURATION
# ========================================
REDIS_RATE_LIMIT_DB=1
REDIS_RATE_LIMIT_PREFIX=rate_limit:
REDIS_RATE_LIMIT_TTL_BUFFER=3600
REDIS_RATE_LIMIT_CLEANUP_INTERVAL=300000

# ========================================
# ENTERPRISE RATE LIMITING CONFIGURATION
# ========================================
ENTERPRISE_RATE_LIMIT_PREFIX=enterprise_rate_limit:
ENTERPRISE_RATE_LIMIT_TTL_BUFFER=3600

# ========================================
# RABBITMQ CONFIGURATION
# ========================================
RABBITMQ_URL=amqp://localhost
RABBITMQ_HOST=localhost
RABBITMQ_PORT=5672
RABBITMQ_USERNAME=guest
RABBITMQ_PASSWORD=guest
RABBITMQ_VHOST=/
RABBITMQ_HEARTBEAT=60
RABBITMQ_TIMEOUT=30000

# ========================================
# gRPC CONFIGURATION
# ========================================
GRPC_SERVER_HOST=localhost
GRPC_SERVER_PORT=50051
GRPC_USER_SERVICE_HOST=localhost
GRPC_USER_SERVICE_PORT=50051
GRPC_USER_SERVICE_TIMEOUT=5000

# ========================================
# JWT & AUTHENTICATION
# ========================================
JWT_SECRET=dev-jwt-secret-change-in-production
JWT_EXPIRY=15m
REFRESH_TOKEN_SECRET=dev-refresh-secret-change-in-production
REFRESH_TOKEN_EXPIRY=7d
COOKIE_SECRET=dev-cookie-secret-change-in-production

# ========================================
# SECURITY CONFIGURATION
# ========================================
BCRYPT_ROUNDS=10
PASSWORD_MIN_LENGTH=8
PASSWORD_MAX_LENGTH=128
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=1000

# ========================================
# AUTHENTICATION SECURITY CONFIGURATION
# ========================================
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=900000
MAX_FAILED_ATTEMPTS=10
ACCOUNT_LOCK_DURATION=3600000

# ========================================
# RATE LIMITING CONFIGURATION
# ========================================
# Default rate limiting configuration
RATE_LIMIT_DEFAULT_WINDOW_MINUTES=15
RATE_LIMIT_DEFAULT_LIMIT=100
REDIS_RATE_LIMIT_DB=1
REDIS_RATE_LIMIT_PREFIX=rate_limit:
REDIS_RATE_LIMIT_TTL_BUFFER=60
REDIS_RATE_LIMIT_CLEANUP_INTERVAL=300000
ENTERPRISE_RATE_LIMIT_PREFIX=enterprise_rate_limit:
ENTERPRISE_RATE_LIMIT_TTL_BUFFER=60

# Global rate limiting
GLOBAL_RATE_LIMIT=100
GLOBAL_RATE_WINDOW=900000

SESSION_TTL_HOURS=24
REFRESH_TOKEN_TTL_DAYS=7
RECENT_SESSIONS_LIMIT=5

# Auth routes rate limiting
AUTH_SIGNUP_LIMIT=5
AUTH_SIGNUP_WINDOW=900000
AUTH_LOGIN_LIMIT=10
AUTH_LOGIN_WINDOW=900000
AUTH_REFRESH_LIMIT=20
AUTH_REFRESH_WINDOW=60000
AUTH_LOGOUT_LIMIT=50
AUTH_LOGOUT_WINDOW=60000

# 2FA rate limiting
AUTH_2FA_ENABLE_LIMIT=5
AUTH_2FA_ENABLE_WINDOW=900000
AUTH_2FA_DISABLE_LIMIT=5
AUTH_2FA_DISABLE_WINDOW=900000
AUTH_2FA_VERIFY_LIMIT=10
AUTH_2FA_VERIFY_WINDOW=300000

# OAuth rate limiting
AUTH_GOOGLE_LIMIT=10
AUTH_GOOGLE_WINDOW=900000
AUTH_GOOGLE_CALLBACK_LIMIT=10
AUTH_GOOGLE_CALLBACK_WINDOW=900000

# Admin rate limiting
AUTH_ADMIN_UNLOCK_LIMIT=20
AUTH_ADMIN_UNLOCK_WINDOW=900000
AUTH_ADMIN_STATUS_LIMIT=30
AUTH_ADMIN_STATUS_WINDOW=900000
AUTH_ADMIN_SUSPEND_LIMIT=20
AUTH_ADMIN_SUSPEND_WINDOW=900000
AUTH_ADMIN_ACTIVATE_LIMIT=20
AUTH_ADMIN_ACTIVATE_WINDOW=900000
AUTH_ADMIN_LOCKED_LIMIT=30
AUTH_ADMIN_LOCKED_WINDOW=900000
AUTH_ADMIN_CACHE_LIMIT=20
AUTH_ADMIN_CACHE_WINDOW=900000

# Dev rate limiting
AUTH_DEV_ACTIVATE_LIMIT=10
AUTH_DEV_ACTIVATE_WINDOW=900000

# Password rate limiting
PASSWORD_CHANGE_LIMIT=10
PASSWORD_CHANGE_WINDOW=60000
PASSWORD_FORGOT_LIMIT=3
PASSWORD_FORGOT_WINDOW=900000
PASSWORD_RESET_LIMIT=3
PASSWORD_RESET_WINDOW=900000
PASSWORD_STATS_LIMIT=20
PASSWORD_STATS_WINDOW=60000
PASSWORD_CLEANUP_LIMIT=10
PASSWORD_CLEANUP_WINDOW=60000

# JWK rate limiting
JWK_JWKS_LIMIT=100
JWK_JWKS_WINDOW=60000
JWK_KEY_LIMIT=50
JWK_KEY_WINDOW=60000
JWK_REFRESH_LIMIT=10
JWK_REFRESH_WINDOW=3600000
JWK_VALIDATE_LIMIT=30
JWK_VALIDATE_WINDOW=60000
JWK_STATS_LIMIT=20
JWK_STATS_WINDOW=60000
JWK_HEALTH_LIMIT=20
JWK_HEALTH_WINDOW=60000

# Email rate limiting
EMAIL_SEND_LIMIT=3
EMAIL_SEND_WINDOW=900000
EMAIL_VERIFY_LIMIT=3
EMAIL_VERIFY_WINDOW=900000
EMAIL_STATS_LIMIT=20
EMAIL_STATS_WINDOW=60000

# Session rate limiting
SESSION_VALIDATE_LIMIT=30
SESSION_VALIDATE_WINDOW=60000
SESSION_CLEANUP_LIMIT=10
SESSION_CLEANUP_WINDOW=60000

# Docs rate limiting
DOCS_SWAGGER_LIMIT=100
DOCS_SWAGGER_WINDOW=900000
DOCS_SPEC_LIMIT=50
DOCS_SPEC_WINDOW=900000
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:8080
CORS_CREDENTIALS=true
ENABLE_HELMET=true
ENABLE_HSTS=false
ENABLE_CSP=true
CSRF_ENABLED=false
SESSION_SECRET=dev-session-secret-change-in-production
SESSION_MAX_AGE=86400000
SESSION_SECURE=false
ENCRYPTION_KEY=dev-32-char-encryption-key-here
ENCRYPTION_ALGORITHM=aes-256-gcm

# ========================================
# INTERNAL SERVICES
# ========================================
USER_SERVICE_URL=http://localhost:8900
USER_SERVICE_TIMEOUT=5000
USER_SERVICE_RETRIES=3
NOTIFICATION_SERVICE_URL=http://localhost:8901
NOTIFICATION_SERVICE_TIMEOUT=5000
NOTIFICATION_SERVICE_RETRIES=3

# ========================================
# FEATURE FLAGS
# ========================================
FEATURE_EMAIL_VERIFICATION=false
FEATURE_PHONE_VERIFICATION=false
FEATURE_2FA=false
FEATURE_SOCIAL_LOGIN=false
FEATURE_PASSWORD_RESET=true
FEATURE_ACCOUNT_LOCKOUT=false
FEATURE_AUDIT_LOGGING=false
FEATURE_METRICS=false

# ========================================
# SERVICE CONFIGURATION
# ========================================
# Password Service Configuration
PASSWORD_OTP_EXPIRY_HOURS=1
PASSWORD_SALT_ROUNDS=10
PASSWORD_MAX_ATTEMPTS=5
PASSWORD_RESEND_COOLDOWN_MINUTES=1
PASSWORD_RECENT_LIMIT=5

# JWK Service Configuration
JWK_ROTATION_INTERVAL_HOURS=24
JWK_MAX_KEYS=5
JWK_CACHE_TTL_HOURS=1
JWK_RSA_KEY_SIZE=2048

# Two Factor Service Configuration
TWO_FACTOR_BACKUP_CODES_COUNT=10
TWO_FACTOR_BACKUP_CODE_LENGTH=8
TWO_FACTOR_DIGITS=6
TWO_FACTOR_PERIOD_SECONDS=30

# Email Service Configuration
EMAIL_OTP_EXPIRY_HOURS=1
EMAIL_SALT_ROUNDS=10

# Rate Limit Service Configuration
RATE_LIMIT_DEFAULT_WINDOW_MINUTES=15

# Auth Service Configuration
AUTH_DEFAULT_LIMIT=20

# Auth Service Security Configuration
AUTH_MAX_LOGIN_ATTEMPTS=5
AUTH_LOCKOUT_DURATION_MINUTES=15
AUTH_MAX_FAILED_ATTEMPTS=10
AUTH_ACCOUNT_LOCK_DURATION_MINUTES=60

# Auth Service Password Security
AUTH_PASSWORD_MIN_LENGTH=8
AUTH_PASSWORD_MAX_LENGTH=128
AUTH_BCRYPT_ROUNDS=10

# Auth Service Rate Limiting
AUTH_LOGIN_RATE_WINDOW_MINUTES=15
AUTH_LOGIN_RATE_LIMIT=10

# JWT Configuration
JWT_SECRET=dev-jwt-secret-change-in-production
JWT_EXPIRY=15m
REFRESH_TOKEN_SECRET=dev-refresh-secret-change-in-production
REFRESH_TOKEN_EXPIRY=7d
JWT_ACCESS_ALGORITHM=RS256
JWT_REFRESH_ALGORITHM=HS256
JWT_ISSUER=auth-service
JWT_AUDIENCE=api-gateway

# OAuth Configuration
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3001/auth/google/callback

# ========================================
# MONITORING & LOGGING
# ========================================
MONITORING_ENABLED=false
METRICS_ENABLED=false
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30000
LOG_LEVEL=warn
LOG_FORMAT=json
LOG_TIMESTAMP=true
LOG_COLORIZE=true
LOG_TO_CONSOLE=true
LOG_TO_FILE=false

# Development-specific logging controls
LOG_AUDIT=false
LOG_CACHE=false
LOG_GRPC=false
LOG_RABBITMQ=false
LOG_DATABASE=false
LOG_HTTP=false

# ========================================
# CACHE CONFIGURATION
# ========================================
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_MAX_SIZE=1000
CACHE_COMPRESSION=true

# ========================================
# CIRCUIT BREAKER CONFIGURATION
# ========================================
CIRCUIT_BREAKER_TIMEOUT=5000
CIRCUIT_BREAKER_ERROR_THRESHOLD=50
CIRCUIT_BREAKER_RESET_TIMEOUT=30000
CIRCUIT_BREAKER_VOLUME_THRESHOLD=10

# ========================================
# DEVELOPMENT UTILITIES
# ========================================
DEV_DEBUG_MODE=false
DEV_HOT_RELOAD=true
DEV_AUTO_SEED=true
DEV_MOCK_DATA=false
DEV_SKIP_AUTH=false
DEV_MOCK_EXTERNAL_SERVICES=true
DEV_ENABLE_TEST_ENDPOINTS=true
DEV_VERBOSE_ERRORS=true
